(()=>{var l="normal",d={NORMAL:"normal",INSERT:"insert",VISUAL:"visual"},s=80,m=10,k={immediate:[{key:"i",mode:"normal",description:"Enter insert mode",handler:()=>(l=d.INSERT,!0)},{key:"h",mode:"normal",description:"Scroll left",handler:e=>{let t=!!e?.repeat,o=t?Math.max(1,s-m):s,n=t?"auto":"smooth";return window.scrollBy({left:-o,behavior:n}),!0}},{key:"j",mode:"normal",description:"Scroll down",handler:e=>{let t=!!e?.repeat,o=t?Math.max(1,s-m):s,n=t?"auto":"smooth";return window.scrollBy({top:o,behavior:n}),!0}},{key:"k",mode:"normal",description:"Scroll up",handler:e=>{let t=!!e?.repeat,o=t?Math.max(1,s-m):s,n=t?"auto":"smooth";return window.scrollBy({top:-o,behavior:n}),!0}},{key:"l",mode:"normal",description:"Scroll right",handler:e=>{let t=!!e?.repeat,o=t?Math.max(1,s-m):s,n=t?"auto":"smooth";return window.scrollBy({left:o,behavior:n}),!0}},{key:"C-j",mode:"normal",description:"Ctrl+J example",handler:()=>!0},{key:"C-d",mode:"normal",description:"Page down",handler:e=>{let t=!!e?.repeat,o=Math.max(1,Math.floor(window.innerHeight*.9)),n=t?Math.max(1,o-m):o,r=t?"auto":"smooth";return window.scrollBy({top:n,behavior:r}),!0}},{key:"C-u",mode:"normal",description:"Page up",handler:e=>{let t=!!e?.repeat,o=Math.max(1,Math.floor(window.innerHeight*.9)),n=t?Math.max(1,o-m):o,r=t?"auto":"smooth";return window.scrollBy({top:-n,behavior:r}),!0}},{key:"gg",mode:"normal",description:"Go to top of document",handler:e=>{let t=e?.repeat?"auto":"smooth";return window.scrollTo({top:0,behavior:t}),!0}},{key:"S-g",mode:"normal",description:"Go to bottom of document",handler:e=>{let t=e?.repeat?"auto":"smooth",o=document.scrollingElement||document.documentElement||document.body;return window.scrollTo({top:o.scrollHeight,behavior:t}),!0}}]},p=new Array(10),h=0,c=0,i=null,M=500;function g(e){return e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function v(e){let t=e.key;if(t==="Shift"||t==="Control"||t==="Alt"||t==="Meta")return null;let o=t.length===1?t.toLowerCase():t,n=[];return e.ctrlKey&&n.push("C"),e.shiftKey&&n.push("S"),(n.length?n.join("-")+"-":"")+o}var E=e=>{let t=v(e);if(!t)return!1;p[c]=t,c=(c+1)%p.length;let o="",n=h;for(;n!==c;)o+=p[n],n=(n+1)%p.length;let r=k.immediate.filter(a=>a.key.startsWith(o));return r.length===0?(h=c,i&&(clearTimeout(i),i=null),!1):r.length===1&&r[0].key===o?(h=c,i&&(clearTimeout(i),i=null),r[0].handler(e),!0):(i&&clearTimeout(i),i=setTimeout(()=>{let a=r.find(u=>u.key===o);a&&a.handler(),h=c,i=null},M),!0)},T=e=>{e.key==="Escape"&&(l=d.NORMAL,e.preventDefault())},y=e=>{switch(l){case d.NORMAL:{e.preventDefault(),E(e);break}case d.INSERT:T(e);break;default:break}},f=e=>{switch(l){case d.NORMAL:{let t=e.target;g(t)&&(l=d.INSERT)}case d.INSERT:break;default:break}};var w="__wer_bootstrap_installed";if(!globalThis[w]){globalThis[w]=!0,document.addEventListener("keydown",y,{capture:!0}),document.addEventListener("click",f,{capture:!0});let e=!1,t=null,o=async()=>(e||t||(t=import(globalThis.chrome&&chrome.runtime&&chrome.runtime.getURL?chrome.runtime.getURL("js/dist/vim_display.js"):"/js/dist/vim_display.js").then(u=>{try{u.initVimDisplay?.()}catch{}return e=!0,u})),t),n=()=>{o().then(a=>a.syncVimDisplay?.(l))},r=()=>{o().then(a=>a.syncVimDisplay?.(l))};document.addEventListener("keydown",n,{capture:!1}),document.addEventListener("click",r,{capture:!1}),chrome.runtime.onMessage.addListener(async a=>{a?.action==="cleanup"&&(document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("click",f,{capture:!0}),document.removeEventListener("keydown",n,{capture:!1}),document.removeEventListener("click",r,{capture:!1}),e&&t?.then(u=>u.cleanupVimDisplay?.()))})}})();
